var BaziCalculator=(function(exports){'use strict';/* Bazi Calculator - https://github.com/alvamind/bazi-calculator-by-alvamind */
var l=["\u7532","\u4E59","\u4E19","\u4E01","\u620A","\u5DF1","\u5E9A","\u8F9B","\u58EC","\u7678"],c=["\u5B50","\u4E11","\u5BC5","\u536F","\u8FB0","\u5DF3","\u5348","\u672A","\u7533","\u9149","\u620C","\u4EA5"],A=["Rat","Ox","Tiger","Rabbit","Dragon","Snake","Horse","Goat","Monkey","Rooster","Dog","Pig"],T={WOOD:["\u7532","\u4E59"],FIRE:["\u4E19","\u4E01"],EARTH:["\u620A","\u5DF1"],METAL:["\u5E9A","\u8F9B"],WATER:["\u58EC","\u7678"]},S={WATER:["\u5B50","\u4EA5"],WOOD:["\u5BC5","\u536F"],FIRE:["\u5DF3","\u5348"],METAL:["\u7533","\u9149"],EARTH:["\u4E11","\u8FB0","\u672A","\u620C"]};var b=[[23,1,"\u5B50"],[1,3,"\u4E11"],[3,5,"\u5BC5"],[5,7,"\u536F"],[7,9,"\u8FB0"],[9,11,"\u5DF3"],[11,13,"\u5348"],[13,15,"\u672A"],[15,17,"\u7533"],[17,19,"\u9149"],[19,21,"\u620C"],[21,23,"\u4EA5"]],W={WOOD:["\u4E11","\u672A"],FIRE:["\u4EA5","\u5DF3"],EARTH:["\u7533","\u5BC5"],METAL:["\u5BC5","\u5348"],WATER:["\u5DF3","\u7533"]},P={WOOD:"\u5DF3",FIRE:"\u7533",EARTH:"\u4EA5",METAL:"\u5B50",WATER:"\u5DF3"},R={WOOD:"\u9149",FIRE:"\u536F",EARTH:"\u5348",METAL:"\u5348",WATER:"\u7533"},h={1:{lucky:["SE","E","S","N"],unlucky:["NW","W","SW","NE"]},2:{lucky:["NE","W","NW","SW"],unlucky:["SE","E","S","N"]},3:{lucky:["S","E","SE","N"],unlucky:["NW","W","SW","NE"]},4:{lucky:["SE","E","S","N"],unlucky:["NW","W","SW","NE"]},6:{lucky:["W","NE","SW","NW"],unlucky:["SE","E","N","S"]},7:{lucky:["NW","W","NE","SW"],unlucky:["SE","E","S","N"]},8:{lucky:["W","NE","SW","NW"],unlucky:["SE","E","S","N"]},9:{lucky:["S","E","SE","N"],unlucky:["NW","W","SW","NE"]}};var y=class{constructor(e){this.dateMappingProvider=e;}getHourBranch(e){let t=b.find(([a,r])=>e>=a&&e<r||a===23&&(e>=23||e<1));return t?t[2]:"\u5B50"}calculateHourStem(e,t){let a=l.indexOf(e)*2%10,r=c.indexOf(t);return l[(a+r)%10]}calculateHourPillar(e,t,a,r){let n=this.getHourBranch(r),i=this.dateMappingProvider.getMapping(e,t,a),s=l[i.HDay-1];if(!s)throw new Error("Invalid day mapping");return this.calculateHourStem(s,n)+n}calculatePillars(e,t,a,r){let n=this.dateMappingProvider.getMapping(e,t,a),i=l[n.HYear-1],s=c[n.EYear-1],u=l[n.HMonth-1],o=c[n.EMonth-1],M=l[n.HDay-1],d=c[n.EDay-1];if(!i||!s||!u||!o||!M||!d)throw new Error("Invalid mapping data");let N=i+s,f=u+o,O=M+d,k=this.calculateHourPillar(e,t,a,r);return {year:this.translatePillar(N),month:this.translatePillar(f),day:this.translatePillar(O),time:this.translatePillar(k)}}translatePillar(e){var i,s;let[t,a]=e.split("");if(!t||!a)throw new Error("Invalid pillar format");let r=((i=Object.entries(T).find(([u,o])=>o.includes(t)))==null?void 0:i[0])||"",n=A[c.indexOf(a)];return {chinese:e,element:r,animal:n,branch:{element:((s=Object.entries(S).find(([u,o])=>o.includes(a)))==null?void 0:s[0])||""}}}};var g=class{calculateLifeGua(e,t){let a=(e-1900)%9+1;return t==="male"?a:10-a}calculateDayMaster(e){let t=e.chinese[0];if(!t)throw new Error("Invalid pillar: missing stem");let a=e.element,r=t.charCodeAt(0)%2===0?"Yin":"Yang";return {stem:t,nature:r,element:a}}calculateNobleman(e,t){return W[e]||[]}calculateIntelligence(e){return P[e]||""}getSkyHorse(e){return {\u5B50:"\u5BC5",\u4E11:"\u536F",\u5BC5:"\u8FB0",\u536F:"\u5DF3",\u8FB0:"\u5348",\u5DF3:"\u672A",\u5348:"\u7533",\u672A:"\u9149",\u7533:"\u620C",\u9149:"\u4EA5",\u620C:"\u5B50",\u4EA5:"\u4E11"}[e]||""}calculatePeachBlossom(e){return R[e]||""}calculateFiveFactors(e){let t={WOOD:0,FIRE:0,EARTH:0,METAL:0,WATER:0};return Object.values(e).forEach(a=>{a.element in t&&t[a.element]++,a.branch.element in t&&t[a.branch.element]++;}),t}calculateEightMansions(e){let t=h[e]||h[1];if(!t)throw new Error(`Invalid life gua: ${e}`);return {group:e%2===0?"West":"East",lucky:{wealth:t.lucky[0]||"SE",health:t.lucky[1]||"E",romance:t.lucky[2]||"S",career:t.lucky[3]||"N"},unlucky:{obstacles:t.unlucky[0]||"NW",quarrels:t.unlucky[1]||"W",setbacks:t.unlucky[2]||"SW",totalLoss:t.unlucky[3]||"NE"}}}};var m=class{constructor(e,t,a,r,n="male",i){this.year=e;this.month=t;this.day=a;this.hour=r;this.gender=n;this.pillarCalculator=new y(i),this.analysisCalculator=new g;}calculatePillars(){return this.pillarCalculator.calculatePillars(this.year,this.month,this.day,this.hour)}calculateBasicAnalysis(){let e=this.calculatePillars(),t=this.analysisCalculator.calculateLifeGua(this.year,this.gender),a=this.analysisCalculator.calculateDayMaster(e.day);return {lifeGua:t,dayMaster:a,nobleman:this.analysisCalculator.calculateNobleman(a.element,a.stem),intelligence:this.analysisCalculator.calculateIntelligence(a.element),skyHorse:this.analysisCalculator.getSkyHorse(e.day.chinese[1]||""),peachBlossom:this.analysisCalculator.calculatePeachBlossom(a.element),fiveFactors:this.analysisCalculator.calculateFiveFactors(e),eightMansions:this.analysisCalculator.calculateEightMansions(t)}}getCompleteAnalysis(){return {mainPillars:this.calculatePillars(),basicAnalysis:this.calculateBasicAnalysis()}}toString(){let e=this.calculatePillars();return `${e.year.chinese}\u5E74${e.month.chinese}\u6708${e.day.chinese}\u65E5${e.time.chinese}\u6642`}};var E=class{constructor(e="/src/dates_mapping.json"){this.mappingsPath=e;this.dateMappings={},this.loadDateMappings();}async loadDateMappings(){try{let e=await fetch(this.mappingsPath);if(!e.ok)throw new Error(`Failed to load date mappings: ${e.statusText}`);this.dateMappings=await e.json();}catch(e){console.error("Failed to load date mappings:",e),this.dateMappings={};}}getMapping(e,t,a){if(!this.dateMappings[e]||!this.dateMappings[e][t]||!this.dateMappings[e][t][a])throw new Error(`No date mapping found for ${e}-${t}-${a}`);return this.dateMappings[e][t][a]}getDateMappingData(){return {mappings:this.dateMappings}}};function G(p,e,t,a,r="male"){let n=new E;return new m(p,e,t,a,r,n)}exports.BaziCalculator=m;exports.BrowserDateMappingLoader=E;exports.createBaziCalculator=G;return exports;})({});//# sourceMappingURL=index.global.js.map
