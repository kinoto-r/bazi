<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>四柱推命：結果</title>
<style>
/* ===== 基本レイアウト ===== */
:root{ --bd:#e5e5e5; --muted:#666; }
body{
  font-family:system-ui,-apple-system,"Hiragino Kaku Gothic ProN","Noto Sans JP",sans-serif;
  margin:24px; line-height:1.7;
}
.card{
  max-width:1100px; margin:auto; padding:20px;
  border:1px solid var(--bd); border-radius:16px;
  box-shadow:0 2px 10px rgba(0,0,0,.05); background:#fff;
}
h1{ font-size:1.3rem; margin:0 0 10px; }
h2{ font-size:1.1rem; margin:18px 0 8px; }
.muted{ color:var(--muted); }
#diag{ margin-top:6px; color:#666; font-size:.9rem; }

/* グリッド＆カード */
.grid4{ display:grid; grid-template-columns:repeat(4,1fr); gap:8px; }
.cell{
  padding:10px; border:1px solid var(--bd); border-radius:10px;
  text-align:center; background:#fff; min-height:72px;
}

/* 共通テーブル */
table{ width:100%; border-collapse:collapse; margin-top:10px; background:#fff; }
th,td{ border:1px solid var(--bd); padding:.45rem; text-align:center; vertical-align:middle; }
th{ background:#f6f6f6; }

/* まとめボックス */
.logic-grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:14px; margin-top:6px; }
.box{ background:#fff; border:1px solid var(--bd); border-radius:10px; padding:10px; }
.box h3{ margin:.1rem 0 .4rem; font-size:1rem; }
.box ul{ margin:.4rem 0 .2rem 1.2rem; }
.box li{ margin:.15rem 0; }

/* レスポンシブ */
@media (max-width:900px){ .logic-grid{ grid-template-columns:repeat(2,1fr); } }
@media (max-width:600px){ .logic-grid{ grid-template-columns:1fr; } }

/* ===== クラシック命式表（印刷想定の簡易） ===== */
table.classic{ width:100%; border-collapse:collapse; background:#fff; margin-top:8px; }
table.classic th, table.classic td{ border:1px solid var(--bd); padding:.55rem; text-align:center; }
table.classic thead th{ background:#f6f6f6; }
table.classic .aux{ background:#fbfeff; min-width:90px; }
table.classic .kw{ background:#f1fbff; font-weight:600; vertical-align:middle; }
table.classic .gz{ font-size:1.05rem; font-weight:600; }
table.classic .gogyou{ color:#555; }
table.classic .subtg{ font-size:.95rem; color:#444; }

/* ===== 新テーブル：命式（拡張） ===== */
.meishiki{
  width:100%; border-collapse:collapse; margin-top:10px; background:#fff;
  font-variant-numeric:tabular-nums;
}
.meishiki th, .meishiki td{
  border:1px solid var(--bd); padding:.45rem; text-align:center; white-space:nowrap;
}
.meishiki thead th{ background:#f6f6f6; }
.meishiki tbody th{ background:#fafafa; text-align:right; padding-right:.6rem; }

/* 1セル内を3分割（天干/陰陽/五行、蔵干区分など） */
.triplet{
  display:grid; grid-template-columns:repeat(3,1fr); gap:0; align-items:center;
}
/* セル風の仕切り */
.triplet > .tcell{
  padding:.35rem .45rem; border-left:1px solid var(--bd);
}
.triplet > .tcell:first-child{ border-left:none; }

/* tcellのラベル（小見出し）を上に表示 */
.triplet > .tcell::before{
  content:attr(data-label);
  display:block; font-size:.75em; line-height:1.1; color:var(--muted);
  margin-bottom:.15rem; font-weight:600; letter-spacing:.02em;
}

/* ===== バッジ風パーツ ===== */
/* ベースはこれ“だけ”に統一（重複定義しない） */
.badge-zy{
  display:inline-block; padding:2px 8px; margin:0 .4em 0 0;
  border:1px solid #ddd; border-radius:999px;
  font-size:.9em; line-height:1.2; background:transparent; color:#333;
}

/* 陰陽（色） */
.badge-zy.yin    { background:#eef2ff !important; border-color:#c7d2fe !important; }
.badge-zy.yang   { background:#fff1db !important; border-color:#ffd9a1 !important; }
.badge-zy.neutral{ background:#f3f4f6 !important; border-color:#e5e7eb !important; color:#555 !important; }

/* 「本/中/余」などの前置きラベル（必要な要素に data-label 付ける） */
.badge-zy[data-label]::before{
  content:attr(data-label) "：";
  color:var(--muted); margin-right:.2rem; font-size:.9em;
}

/* 蔵干“文字”用の丸角チップ（区分とは別の見た目を出したい場合） */
.zang-chip{
  display:inline-block; padding:2px 6px; border-radius:6px;
  border:1px solid #ddd; margin-right:6px; font-size:.92em; line-height:1.6;
  background:#f6f6f6; color:#333;
}
.zang-chip.yin{ background:#f3f4ff; }
.zang-chip.yang{ background:#fff3e0; }
.zang-chip.neutral{ background:#f6f6f6; color:#777; }

/* ===== スクロール保護＆安定幅（クラシック表の横崩れ対策） ===== */
.table-wrap{ width:100%; overflow-x:auto; -webkit-overflow-scrolling:touch; }
.classic-table{
  width:100%; border-collapse:collapse; table-layout:fixed; min-width:680px;
}
.classic-table th, .classic-table td{
  padding:6px 8px; border:1px solid #ddd; vertical-align:middle; word-break:keep-all;
}
@media (max-width:768px){
  .classic-table{ min-width:560px; font-size:13px; }
  .classic-table th, .classic-table td{ padding:4px 6px; }
}
@media (max-width:480px){
  .classic-table{ min-width:520px; font-size:12px; }
  .classic-table .badge-zy{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:96px; display:inline-block; }
}

/* 行単位の微調整（任意） */
#row_stem td{ font-size:.95em; color:#333; }

/* ===== 五行カラー（蔵干区分とトーンを揃えつつ強め）=====
   ※ 最後に置いて他のルールに勝つようにする */
.badge-zy.el-木 { background:#d9f0e2 !important; border-color:#9cd3ae !important; }
.badge-zy.el-火 { background:#ffd9cc !important; border-color:#ffb8a3 !important; }
.badge-zy.el-土 { background:#ffeebc !important; border-color:#e8ce77 !important; }
.badge-zy.el-金 { background:#dbe8ff !important; border-color:#b9d0ff !important; }
.badge-zy.el-水 { background:#d9f2ff !important; border-color:#aee6ff !important; }

</style>

</head>
<body>
<div class="card">
  <h1>四柱推命：結果</h1>
  <div id="summary" class="muted"></div>
  <div id="diag" class="muted">データ読込中...</div>
<h2>命式</h2>
<div class="table-wrap">
  <table id="classicTable" class="meishiki classic-table">
    <thead>
      <tr>
        <th></th>
        <th>時柱</th>
        <th>日柱</th>
        <th>月柱</th>
        <th>年柱</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>干支(天干＋地支）</th>
        <td id="c_time_gz">—</td>
        <td id="c_day_gz">—</td>
        <td id="c_month_gz">—</td>
        <td id="c_year_gz">—</td>
      </tr>
     <tr id="row_stem">
       <th>天干（陰陽・五行）</th>
      <td id="c_time_g"></td>
       <td id="c_day_g"></td>
      <td id="c_month_g"></td>
      <td id="c_year_g"></td>
   </tr>
      <tr>
        <th>通変星（天干）</th>
        <td id="c_time_tg">—</td>
        <td id="c_day_tg">—</td>
        <td id="c_month_tg">—</td>
        <td id="c_year_tg">—</td>
      </tr>

   <tr id="row_zhi">
  <th>地支（陰陽・五行）</th>
  <td id="zhi_h">—</td>  <!-- 時 -->
  <td id="zhi_d">—</td>  <!-- 日 -->
  <td id="zhi_m">—</td>  <!-- 月 -->
  <td id="zhi_y">—</td>  <!-- 年 -->
</tr>
<tr>
  <th>通変星（蔵干・代表）</th>
  <td id="c_time_zang_tg_main">—</td>
  <td id="c_day_zang_tg_main">—</td>
  <td id="c_month_zang_tg_main">—</td>
  <td id="c_year_zang_tg_main">—</td>
</tr>

      <tr>
        <th>蔵干（区分）</th>
        <td>
          <div class="triplet">
            <span class="badge-zy neutral" id="c_time_zang_hon" data-label="本">－</span>
            <span class="badge-zy neutral" id="c_time_zang_mid" data-label="中">－</span>
            <span class="badge-zy neutral" id="c_time_zang_rem" data-label="余">－</span>
          </div>
        </td>
        <td>
          <div class="triplet">
            <span class="badge-zy neutral" id="c_day_zang_hon" data-label="本">－</span>
            <span class="badge-zy neutral" id="c_day_zang_mid" data-label="中">－</span>
            <span class="badge-zy neutral" id="c_day_zang_rem" data-label="余">－</span>
          </div>
        </td>
        <td>
          <div class="triplet">
            <span class="badge-zy neutral" id="c_month_zang_hon" data-label="本">－</span>
            <span class="badge-zy neutral" id="c_month_zang_mid" data-label="中">－</span>
            <span class="badge-zy neutral" id="c_month_zang_rem" data-label="余">－</span>
          </div>
        </td>
        <td>
          <div class="triplet">
            <span class="badge-zy neutral" id="c_year_zang_hon" data-label="本">－</span>
            <span class="badge-zy neutral" id="c_year_zang_mid" data-label="中">－</span>
            <span class="badge-zy neutral" id="c_year_zang_rem" data-label="余">－</span>
          </div>
        </td>
      </tr>

      <tr>
        <th>通変星（蔵干）</th>
        <td>
          <div class="triplet">
            <span class="tcell" id="c_time_zang_tg_hon" data-label="本">—</span>
            <span class="tcell" id="c_time_zang_tg_mid" data-label="中">—</span>
            <span class="tcell" id="c_time_zang_tg_rem" data-label="余">—</span>
          </div>
        </td>
        <td>
          <div class="triplet">
            <span class="tcell" id="c_day_zang_tg_hon" data-label="本">—</span>
            <span class="tcell" id="c_day_zang_tg_mid" data-label="中">—</span>
            <span class="tcell" id="c_day_zang_tg_rem" data-label="余">—</span>
          </div>
        </td>
        <td>
          <div class="triplet">
            <span class="tcell" id="c_month_zang_tg_hon" data-label="本">—</span>
            <span class="tcell" id="c_month_zang_tg_mid" data-label="中">—</span>
            <span class="tcell" id="c_month_zang_tg_rem" data-label="余">—</span>
          </div>
        </td>
        <td>
          <div class="triplet">
            <span class="tcell" id="c_year_zang_tg_hon" data-label="本">—</span>
            <span class="tcell" id="c_year_zang_tg_mid" data-label="中">—</span>
            <span class="tcell" id="c_year_zang_tg_rem" data-label="余">—</span>
          </div>
        </td>
      </tr>

      <tr>
        <th>十二運星</th>
        <td id="c_time_12un">—</td>
        <td id="c_day_12un">—</td>
        <td id="c_month_12un">—</td>
        <td id="c_year_12un">—</td>
      </tr>

      <tr>
        <th>十二運（数）</th>
        <td id="c_time_12un_val">—</td>
        <td id="c_day_12un_val">—</td>
        <td id="c_month_12un_val">—</td>
        <td id="c_year_12un_val">—</td>
      </tr>

      <tr>
        <th>九星（簡易）</th>
        <td id="c_kyusei" colspan="4">—</td>
      </tr>

      <!-- ご要望の順：生年天中殺 → 天中殺（空亡＝日） -->
      <tr>
        <th>生年天中殺（空亡）</th>
        <td id="kwYear" colspan="4">—</td>
      </tr>
      <tr>
        <th>日中天中殺（空亡）</th>
        <td id="kwDay" colspan="4">—</td>
      </tr>

      <tr>
        <th>身強弱</th>
        <td id="strength" colspan="4"></td>
      </tr>
      <tr>
        <th>格局</th>
        <td id="kakkyoku" colspan="4"></td>
      </tr>
      <tr>
        <th>用神・喜神・忌神・仇神</th>
        <td colspan="4"><div id="yojin"></div></td>
      </tr>
    </tbody>
  </table>
</div>
  <!-- エネルギー -->
  <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px">
    <div><h2>五行バランス</h2><div id="energy"></div></div>
  </div>

  <!-- 成敗 -->
  <h2>成敗ロジック</h2>
  <div class="logic-grid">
    <div class="box">
      <h3>透干（天透）</h3>
      <div id="toko"></div>
    </div>
    <div class="box">
      <h3>合・冲・刑・害</h3>
      <div id="relations"></div>
    </div>
    <div class="box">
      <h3>調候</h3>
      <div id="choko"></div>
    </div>
    <div class="box">
      <h3>天剋地冲</h3>
      <div id="tkdc"></div>
    </div>
    <div class="box">
      <h3>守護神（調候優先）</h3>
      <div id="guardian"></div>
    </div>
  </div>

<!-- ライブラリ（同階層の index.global.js） -->
<script src="./index.global.js?v=1" charset="utf-8"></script>
<!-- 本体 -->
<script defer src="./app.js?v=62" charset="utf-8"></script>

<!-- ▼▼▼ 大運表（表示専用。app.js が描画） ▼▼▼ -->
<style>
  /* 見本に寄せた軽いスタイル */
  #daiunSection table{width:100%;border-collapse:collapse;font-size:14px}
  #daiunSection th,#daiunSection td{border:1px solid #999;padding:8px 10px;text-align:left;vertical-align:top}
  #daiunSection thead th{background:#f8f7e7;color:#333;position:sticky;top:0}
  #daiunSection tbody tr:nth-child(odd) td{background:#eef7ff55}
  #daiunSection .muted{color:#6b7280;font-size:12px}
  #daiunSection .tag{display:inline-block;padding:2px 8px;border:1px solid #bbb;border-radius:999px;margin-right:6px;font-size:12px}
  #daiunSection .ok{border-color:#2f6} .warn{border-color:#fd6} .bad{border-color:#f66}
</style>

<section id="daiunSection" style="margin-top:30px;display:none">
  <h2 style="font-size:18px;margin:0 0 10px">大運</h2>
  <table id="daiunTable">
    <thead>
      <tr>
        <th>年齢</th>
        <th>干支</th>
        <th>通変星</th>
        <th>十二運星</th>
        <th>関係</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</section>
<section id="liunianSection" style="margin-top:30px;display:none">
  <h2 style="font-size:18px;margin:0 0 10px">年運</h2>
  <table id="liunianTable" style="width:100%;border-collapse:collapse;font-size:14px">
    <thead>
      <tr>
        <th style="border:1px solid #999;padding:8px 10px;text-align:left">西暦</th>
        <th style="border:1px solid #999;padding:8px 10px;text-align:left">年齢</th>
        <th style="border:1px solid #999;padding:8px 10px;text-align:left">干支</th>
        <th style="border:1px solid #999;padding:8px 10px;text-align:left">通変星</th>
        <th style="border:1px solid #999;padding:8px 10px;text-align:left">十二運星</th>
        <th style="border:1px solid #999;padding:8px 10px;text-align:left">関係</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

</body>
</html>
